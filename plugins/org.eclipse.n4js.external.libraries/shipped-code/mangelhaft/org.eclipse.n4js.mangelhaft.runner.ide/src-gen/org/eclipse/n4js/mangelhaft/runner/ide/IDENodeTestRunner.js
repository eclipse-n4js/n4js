// Generated by N4JS transpiler; for copyright see original N4JS source file.

(function(System) {
	'use strict';
	System.register([
		'n4js.lang/src-gen/n4js/lang/N4Injector',
		'org.eclipse.n4js.mangelhaft/src-gen/org/eclipse/n4js/mangelhaft/Test',
		'org.eclipse.n4js.mangelhaft/src-gen/org/eclipse/n4js/mangelhaft/TestController',
		'org.eclipse.n4js.mangelhaft.reporter.ide/src-gen/org/eclipse/n4js/mangelhaft/reporter/ide/IDEReporter',
		'org.eclipse.n4js.mangelhaft/src-gen/org/eclipse/n4js/mangelhaft/types/TestDIComponent'
	], function($n4Export) {
		var N4Injector, FIXME1, FIXME2, IFIXME, IFIXME2, TestController, IDEReporter, TestDIComponent, IDENodeTestRunner, TestBinder, Root, parentinj, root, main;
		IDENodeTestRunner = function IDENodeTestRunner() {
			this.controller = undefined;
			this.reporter = undefined;
		};
		TestBinder = function TestBinder() {};
		Root = function Root() {
			this.runner = undefined;
		};
		return {
			setters: [
				function($exports) {
					// n4js.lang/src-gen/n4js/lang/N4Injector
					N4Injector = $exports.N4Injector;
				},
				function($exports) {
					// org.eclipse.n4js.mangelhaft/src-gen/org/eclipse/n4js/mangelhaft/Test
					FIXME1 = $exports.FIXME1;
					FIXME2 = $exports.FIXME2;
					IFIXME = $exports.IFIXME;
					IFIXME2 = $exports.IFIXME2;
				},
				function($exports) {
					// org.eclipse.n4js.mangelhaft/src-gen/org/eclipse/n4js/mangelhaft/TestController
					TestController = $exports.TestController;
				},
				function($exports) {
					// org.eclipse.n4js.mangelhaft.reporter.ide/src-gen/org/eclipse/n4js/mangelhaft/reporter/ide/IDEReporter
					IDEReporter = $exports.IDEReporter;
				},
				function($exports) {
					// org.eclipse.n4js.mangelhaft/src-gen/org/eclipse/n4js/mangelhaft/types/TestDIComponent
					TestDIComponent = $exports.TestDIComponent;
				}
			],
			execute: function() {
				$makeClass(IDENodeTestRunner, N4Object, [], {
					run: {
						value: async function run___n4() {
							try {
								let testInfos = await this.getTestCatalog();
								this.reporter.endpoint = testInfos.endpoint;
								this.controller.reporters = [
									this.reporter
								];
								await this.controller.runGroups(testInfos, 100, n4.runtimeOptions.testScope);
							} catch(err) {
								if ($instanceof(err, Error)) {
									console.error(err + "\stack: " + (err).stack.replace(/^Error:?\s*/, ""));
								}
								throw err;
							}
						}
					},
					getTestCatalog: {
						value: async function getTestCatalog___n4() {
							let catalogDef = n4.runtimeOptions["test-catalog"];
							let testCatalog = catalogDef;
							if (typeof catalogDef === "string") {
								let response = await fetch(catalogDef, {
									headers: {
										'Content-Type': "application/vnd.n4js.assemble_test_catalog_req.tm+json"
									}
								});
								testCatalog = (await response.json());
							}
							return testCatalog;
						}
					},
					controller: {
						value: undefined,
						writable: true
					},
					reporter: {
						value: undefined,
						writable: true
					}
				}, {}, function(instanceProto, staticProto) {
					var metaClass = new N4Class({
						name: 'IDENodeTestRunner',
						origin: 'org.eclipse.n4js.mangelhaft.runner.ide',
						fqn: 'org.eclipse.n4js.mangelhaft.runner.ide.IDENodeTestRunner.IDENodeTestRunner',
						n4superType: N4Object.n4type,
						allImplementedInterfaces: [],
						ownedMembers: [
							new N4DataField({
								name: 'controller',
								isStatic: false,
								annotations: [
									new N4Annotation({
										name: 'Inject',
										details: []
									})
								]
							}),
							new N4DataField({
								name: 'reporter',
								isStatic: false,
								annotations: [
									new N4Annotation({
										name: 'Inject',
										details: []
									})
								]
							}),
							new N4Method({
								name: 'run',
								isStatic: false,
								jsFunction: instanceProto['run'],
								annotations: [
									new N4Annotation({
										name: 'Final',
										details: []
									})
								]
							}),
							new N4Method({
								name: 'getTestCatalog',
								isStatic: false,
								jsFunction: instanceProto['getTestCatalog'],
								annotations: []
							})
						],
						consumedMembers: [],
						annotations: []
					});
					return metaClass;
				});
				Object.defineProperty(IDENodeTestRunner, '$di', {
					value: {
						fieldsInjectedTypes: [
							{
								name: 'controller',
								type: TestController
							},
							{
								name: 'reporter',
								type: IDEReporter
							}
						]
					}
				});
				$makeClass(TestBinder, N4Object, [], {}, {}, function(instanceProto, staticProto) {
					var metaClass = new N4Class({
						name: 'TestBinder',
						origin: 'org.eclipse.n4js.mangelhaft.runner.ide',
						fqn: 'org.eclipse.n4js.mangelhaft.runner.ide.IDENodeTestRunner.TestBinder',
						n4superType: N4Object.n4type,
						allImplementedInterfaces: [],
						ownedMembers: [],
						consumedMembers: [],
						annotations: [
							new N4Annotation({
								name: 'Bind',
								details: [
									'IFIXME',
									'FIXME1'
								]
							}),
							new N4Annotation({
								name: 'Bind',
								details: [
									'IFIXME2',
									'FIXME2'
								]
							}),
							new N4Annotation({
								name: 'Binder',
								details: []
							})
						]
					});
					return metaClass;
				});
				Object.defineProperty(TestBinder, '$di', {
					value: {
						bindings: [
							{
								from: IFIXME,
								to: FIXME1
							},
							{
								from: IFIXME2,
								to: FIXME2
							}
						],
						methodBindings: [],
						fieldsInjectedTypes: []
					}
				});
				$makeClass(Root, N4Object, [], {
					runner: {
						value: undefined,
						writable: true
					}
				}, {}, function(instanceProto, staticProto) {
					var metaClass = new N4Class({
						name: 'Root',
						origin: 'org.eclipse.n4js.mangelhaft.runner.ide',
						fqn: 'org.eclipse.n4js.mangelhaft.runner.ide.IDENodeTestRunner.Root',
						n4superType: N4Object.n4type,
						allImplementedInterfaces: [],
						ownedMembers: [
							new N4DataField({
								name: 'runner',
								isStatic: false,
								annotations: [
									new N4Annotation({
										name: 'Inject',
										details: []
									})
								]
							})
						],
						consumedMembers: [],
						annotations: [
							new N4Annotation({
								name: 'GenerateInjector',
								details: []
							}),
							new N4Annotation({
								name: 'WithParentInjector',
								details: [
									'TestDIComponent'
								]
							}),
							new N4Annotation({
								name: 'UseBinder',
								details: [
									'TestBinder'
								]
							})
						]
					});
					return metaClass;
				});
				Object.defineProperty(Root, '$di', {
					value: {
						parent: TestDIComponent,
						binders: [
							TestBinder
						],
						fieldsInjectedTypes: [
							{
								name: 'runner',
								type: IDENodeTestRunner
							}
						]
					}
				});
				parentinj = N4Injector.of(TestDIComponent);
				root = N4Injector.of(Root, parentinj).create(Root);
				main = root.runner;
				$n4Export('default', main);
			}
		};
	});
})(typeof module !== 'undefined' && module.exports ? require('n4js-node').System(require, module) : System);
//# sourceMappingURL=IDENodeTestRunner.map
